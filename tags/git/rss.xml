<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Git on 筆記Zone</title>
        <link>https://zonego.tw/tags/git/</link>
        <description>Recent content in Git on 筆記Zone</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-tw</language>
        <lastBuildDate>Tue, 11 Mar 2025 13:07:50 +0800</lastBuildDate><atom:link href="https://zonego.tw/tags/git/rss.xml" rel="self" type="application/rss+xml" /><item>
        <title>Woodpeak Git Push 至私有 git</title>
        <link>https://zonego.tw/post/woodpeak-git-push/</link>
        <pubDate>Tue, 11 Mar 2025 13:07:50 +0800</pubDate>
        
        <guid>https://zonego.tw/post/woodpeak-git-push/</guid>
        <description>&lt;img src="https://images.unsplash.com/photo-1556075798-4825dfaaf498?q=80&amp;w=2952&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Featured image of post Woodpeak Git Push 至私有 git" /&gt;&lt;h2 id=&#34;git-連線限制&#34;&gt;&lt;a href=&#34;#git-%e9%80%a3%e7%b7%9a%e9%99%90%e5%88%b6&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;Git 連線限制
&lt;/h2&gt;&lt;p&gt;最近在設定部落格的自動更新，發現自己架的 gitea 伺服器只有對外開放 https&lt;br&gt;
git 指令內預設是走 ssh 才能使用免密碼，用 key 作身分驗證&lt;br&gt;
為了解決身分驗證的問題，花了一些時間整理解決方式&lt;/p&gt;
&lt;p&gt;如果你的目的是 GitHub 或 GitLab 這種不是自己架的，不會有這問題&lt;/p&gt;
&lt;p&gt;順便紀錄怎麼使用 drone-git-push&lt;/p&gt;
&lt;h3 id=&#34;1-改用-https--帳號密碼驗證&#34;&gt;&lt;a href=&#34;#1-%e6%94%b9%e7%94%a8-https--%e5%b8%b3%e8%99%9f%e5%af%86%e7%a2%bc%e9%a9%97%e8%ad%89&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;1. 改用 https + 帳號密碼驗證
&lt;/h3&gt;&lt;p&gt;如果原本 gitea 就已經設定好 https 連線，這是簡單方便的方式，只要改專案的CICD設定就好了&lt;br&gt;
將 git remote 的設定字串，改成下面的格式就好了&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34; code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 secret-remote-string&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;secret-remote-string&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;https://username:password@your.gitea.com/username/repository.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;如果擔心明文會洩漏帳號密碼，可以用 woodpecker secret&lt;br&gt;
先在 woodpecker 中加入上面的 remote 字串，到專案的 secret&lt;br&gt;
再改專案中的 .woodpecker 設定檔， remote 的地方改成調用 secret&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;steps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Commit changes&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;branch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from_secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;secret-remote-string&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h3 id=&#34;2-ip直連&#34;&gt;&lt;a href=&#34;#2-ip%e7%9b%b4%e9%80%a3&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;2. IP直連
&lt;/h3&gt;&lt;p&gt;假設已經準備好 ssh key (如果沒有，可以跳去後面看完整教學)&lt;/p&gt;
&lt;p&gt;預先調整網路設定，讓 woodpecker 伺服器跟 gitea 伺服器可以用 IP 直連&lt;br&gt;
例如穿透、轉發或乾脆放同網段&lt;/p&gt;
&lt;p&gt;改完之後，將 git remote 改成如下格式，搭配原本的 key 連線即可&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34; code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git@gitea-ip:username/repository.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;如果 gitea 的 ssh port 不是在預設的 22&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34; code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh://git@gitea-ip:port/username/repository.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h3 id=&#34;3-revers-proxy-轉發-22-port&#34;&gt;&lt;a href=&#34;#3-revers-proxy-%e8%bd%89%e7%99%bc-22-port&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;3. revers proxy 轉發 22 port
&lt;/h3&gt;&lt;p&gt;這個方法是第一個方法的延伸，如果有時間設定建議可以改成這樣，後面使用也比較方便&lt;br&gt;
既然 gitea 用非標準的 port，那就在 revers proxy 改回來就好了&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;當然，如果你能直接改 gitea 的 port 最省事&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;通常 revers proxy 會設定讓大部分內網段都能連到(至少我是這樣設定)，不用再重複設定網段穿透&lt;br&gt;
至於對不對外開放可以另外考慮，我只設定內網不同網段也可以連到&lt;/p&gt;
&lt;p&gt;設定方式請參考 &lt;a class=&#34;link&#34; href=&#34;https://zonego.tw/post/gitea/&#34; &gt;Gitea - 自己的 Git 自己架&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;drone-git-push-使用教學&#34;&gt;&lt;a href=&#34;#drone-git-push-%e4%bd%bf%e7%94%a8%e6%95%99%e5%ad%b8&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;drone-git-push 使用教學
&lt;/h2&gt;&lt;p&gt;例如使用 ssh key 認證，push 到 github 上&lt;/p&gt;
&lt;h3 id=&#34;設定連線-ssh-key&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a%e9%80%a3%e7%b7%9a-ssh-key&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定連線 SSH Key
&lt;/h3&gt;&lt;p&gt;使用指令產生公私鑰&lt;/p&gt;
&lt;div class=&#34;terminal&#34; role=&#34;figure&#34; aria-label=&#34;terminal code snippet&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class=&#34;terminal-title&#34;&gt;bash&lt;/div&gt;
    
  &lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;bash&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh-keygen -f keyname&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;p&gt;中間 -f 可以自行選擇存放的位置跟檔名&lt;br&gt;
如果沒指定 -f ，預設存在 &lt;code&gt;~/.ssh/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;完成之後會生成 keyname 跟 keyname.pub 兩個檔案&lt;br&gt;
keyname.pub 就是公鑰&lt;br&gt;
keyname 就是私鑰，必須要保存好&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;將公鑰上傳到 github&lt;/p&gt;
&lt;p&gt;到 github 點右上角大頭貼 &amp;gt; settings &amp;gt; 左邊 SSH and GPG keys&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/woodpeak-git-push/github_keys.png&#34;
	width=&#34;3104&#34;
	height=&#34;1834&#34;
	srcset=&#34;https://zonego.tw/post/woodpeak-git-push/github_keys_hu_9e58bbc05cdc4201.png 480w, https://zonego.tw/post/woodpeak-git-push/github_keys_hu_29b7ca2a2b16744f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;406px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;點 new SSH key， title 打方便辨識的名字，例如我就放一個 Key 是 woodpecker 專用&lt;br&gt;
將 keyname.pub 的內容貼上就完成了&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/woodpeak-git-push/github_keys2.png&#34;
	width=&#34;3104&#34;
	height=&#34;1834&#34;
	srcset=&#34;https://zonego.tw/post/woodpeak-git-push/github_keys2_hu_18762a9e925eeeec.png 480w, https://zonego.tw/post/woodpeak-git-push/github_keys2_hu_11e5c8596aed0bfa.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;406px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;將公鑰的內容貼進去就可以了&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;將私鑰內容貼到 woodpecker secret&lt;/p&gt;
&lt;p&gt;打開 woodpecker 到專案內點齒輪設定 &amp;gt; Secrets&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker.png&#34;
	width=&#34;3104&#34;
	height=&#34;1834&#34;
	srcset=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker_hu_d6e7ec3d742bbbf5.png 480w, https://zonego.tw/post/woodpeak-git-push/woodpecker_hu_d3931060d6d3799e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;406px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker_secret.png&#34;
	width=&#34;3104&#34;
	height=&#34;1834&#34;
	srcset=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker_secret_hu_ea7182b01225486b.png 480w, https://zonego.tw/post/woodpeak-git-push/woodpecker_secret_hu_506c56d438b69bf1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;406px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;點 add secrets&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker_secret2.png&#34;
	width=&#34;3104&#34;
	height=&#34;1834&#34;
	srcset=&#34;https://zonego.tw/post/woodpeak-git-push/woodpecker_secret2_hu_e2cf2fe7c3f40b67.png 480w, https://zonego.tw/post/woodpeak-git-push/woodpecker_secret2_hu_b08cda78fb873885.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;406px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;name 可以寫個方便辨識的名字&lt;br&gt;
value 貼上私鑰的內容 (END後面的換行要保留)&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34; code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 value&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;value&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-----BEGIN OPENSSH PRIVATE KEY-----
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;abcdefghi...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;OOXXc=
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;-----END OPENSSH PRIVATE KEY-----&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;Avalable Plugin 可以指定這個 secret 只有哪個步驟能用&lt;br&gt;
例如我可以填上 &lt;code&gt;appleboy/drone-git-push&lt;/code&gt;，就只有 image 用到 drone-git-push 這些步驟能用&lt;br&gt;
留空白代表不限制&lt;/p&gt;
&lt;p&gt;Avalable at following event 可以指定在哪些 git 或 woodpecker 操作可以使用這個 secret&lt;br&gt;
這邊的 git 操作指的是你的操作觸發 woodpecker，而不是 drone-git-push 內的動作&lt;/p&gt;
&lt;h3 id=&#34;woodpecker-設定檔&#34;&gt;&lt;a href=&#34;#woodpecker-%e8%a8%ad%e5%ae%9a%e6%aa%94&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;woodpecker 設定檔
&lt;/h3&gt;&lt;p&gt;照前面設定把 Key 跟 secret 設定好之後，就可以在流程內加步驟了&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;push git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;environment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_BRANCH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_SSH_KEY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from_secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;github_key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_REMOTE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;git@github.com:user/repo.git&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_AUTHOR_NAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_AUTHOR_EMAIL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;email&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_COMMIT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_COMMIT_MESSAGE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Auto generated using Woodpecker CI&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;上面寫的是基本用法&lt;br&gt;
如果除了 git push 的指令還需要跑別的東西，可以用 &lt;code&gt;commands&lt;/code&gt;&lt;br&gt;
例如，我的編譯跑完之後，我只想推送編譯完的檔案出去，而不是專案原始碼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;先 cd 進到編譯完的 public 資料夾&lt;/li&gt;
&lt;li&gt;初始化儲存庫&lt;/li&gt;
&lt;li&gt;強制推送至 github&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deploy git page&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;environment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_BRANCH&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_SSH_KEY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from_secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;github_key&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_REMOTE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;git@github.com:ZoneLin/blog-public.git&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_AUTHOR_NAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;zoneLin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_AUTHOR_EMAIL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;th5331958@gmail.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_FORCE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_COMMIT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;PLUGIN_COMMIT_MESSAGE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Auto generated using Woodpecker CI&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;commands&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;cd public&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;git init&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;/bin/drone-git-push&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;隨副 drone-git-push 用法參考&lt;br&gt;
&lt;a class=&#34;link&#34; href=&#34;https://woodpecker-ci.org/plugins/Git%20Push&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://woodpecker-ci.org/plugins/Git%20Push&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;參考來源&#34;&gt;&lt;a href=&#34;#%e5%8f%83%e8%80%83%e4%be%86%e6%ba%90&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;參考來源
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://nanxiao.me/git-clone-ssh-non-22-port/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;处理git clone命令的非标准SSH端口连接&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://stackoverflow.com/questions/10054318/how-do-i-provide-a-username-and-password-when-running-git-clone-gitremote-git&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;stackoverflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;div class=&#34;unsplash unsplash-info&#34; &gt;
    &lt;div class=&#34;unsplash-title&#34;&gt;&lt;svg  xmlns=&#34;http://www.w3.org/2000/svg&#34;  width=&#34;24&#34;  height=&#34;24&#34;  viewBox=&#34;0 0 24 24&#34;  fill=&#34;none&#34;  stroke=&#34;currentColor&#34;  stroke-width=&#34;2&#34;  stroke-linecap=&#34;round&#34;  stroke-linejoin=&#34;round&#34;  class=&#34;icon unsplash-icon icon unsplash-icon-tabler icon unsplash-icons-tabler-outline icon unsplash-icon-tabler-photo&#34;&gt;&lt;path stroke=&#34;none&#34; d=&#34;M0 0h24v24H0z&#34; fill=&#34;none&#34;/&gt;&lt;path d=&#34;M15 8h.01&#34; /&gt;&lt;path d=&#34;M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z&#34; /&gt;&lt;path d=&#34;M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5&#34; /&gt;&lt;path d=&#34;M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3&#34; /&gt;&lt;/svg&gt;&lt;/div&gt;
    &lt;p&gt;Photo by &lt;a href=&#34;https://unsplash.com/@yancymin?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash&#34;&gt;Yancy Min&lt;/a&gt; on &lt;a href=&#34;https://unsplash.com/photos/a-close-up-of-a-text-description-on-a-computer-screen-842ofHC6MaI?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash&#34;&gt;Unsplash&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
        </item>
        <item>
        <title>Cloudflare Page 架站教學</title>
        <link>https://zonego.tw/post/cloudflare-page/</link>
        <pubDate>Fri, 10 Feb 2023 12:39:40 +0800</pubDate>
        
        <guid>https://zonego.tw/post/cloudflare-page/</guid>
        <description>&lt;img src="https://zonego.tw/post/cloudflare-page/cloudflare-page.png" alt="Featured image of post Cloudflare Page 架站教學" /&gt;&lt;p&gt;Cloudflare Page 使用上跟 GitHub Page 類似&lt;br&gt;
就差在 GitHub Page 只能用靜態網站檔案，用框架產生的靜態網站就必須先編好才能推上去儲藏庫&lt;br&gt;
Cloudflare Page 可以支援編譯&lt;/p&gt;
&lt;h2 id=&#34;設定步驟&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a%e6%ad%a5%e9%a9%9f&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定步驟
&lt;/h2&gt;&lt;p&gt;官方文件 &lt;a class=&#34;link&#34; href=&#34;https://developers.cloudflare.com/pages/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://developers.cloudflare.com/pages/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;簡單步驟總結：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在 GitHub 或 GitLab 建立網頁用的儲藏庫 (repository)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cloudflare page 連結 GitHub 或 GitLab&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在 Cloudflare 設定網站用的 domain name&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;完成🎉&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;設定-git-儲藏庫&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a-git-%e5%84%b2%e8%97%8f%e5%ba%ab&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定 Git 儲藏庫
&lt;/h3&gt;&lt;p&gt;首先到 GitHub 或 GitLab 建立網頁用的儲藏庫 (就基本的 git 操作，這邊就不多作教學)&lt;/p&gt;
&lt;p&gt;網站內容跟 GitHub Page 一樣，只要是靜態網站都可以，不管是直接寫或是用框架產生都可以&lt;br&gt;
比 GitHub Page 好的一點是，可以直接推送框架的程式上去，部署時編譯&lt;br&gt;
但免費版有限制，所以我還是習慣推送已經編好的上去&lt;/p&gt;
&lt;p&gt;GitHub Page 跟 Cloudflare page 也不需要太糾結要用哪個，反正都免費都可以先用看看&lt;br&gt;
例如本網站的內容就是用 Hexo 框架產生，先推送到 GitHub Page，Cloudflare page 用同個儲藏庫當來源&lt;/p&gt;
&lt;p&gt;在 &lt;a class=&#34;link&#34; href=&#34;https://zonelin.github.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zonelin.github.io/&lt;/a&gt; 也可以找到本站&lt;/p&gt;
&lt;h3 id=&#34;cloudflare-新增-page-專案&#34;&gt;&lt;a href=&#34;#cloudflare-%e6%96%b0%e5%a2%9e-page-%e5%b0%88%e6%a1%88&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;Cloudflare 新增 page 專案
&lt;/h3&gt;&lt;p&gt;登入 Cloudflare 在 page 設定內新增一個專案　&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject_hu_c161938c3861a6bf.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-addproject_hu_a2b43c703eed7a19.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare add project&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;登入 GitHub 或 GitLab 選擇要用的存儲庫 repository&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-git.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-git_hu_52ac97e7ca62ce42.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-addproject-git_hu_3943888ffb734ce9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare add project&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;設定要觸發抓取的分支 (建議把部署跟開發中做不同的分支)&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting_hu_77e0a3be8d9b02cd.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting_hu_f7696a010ea149ec.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare add project&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;如果是想要推送後，再用框架產生靜態網頁可以調整這邊設定&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting2.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting2_hu_f93998f5e8eb3c1e.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-addproject-setting2_hu_8ac2ab37870294dc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare add project&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;點儲存部屬 Save and Deploy 後會開始從 Git 存儲庫抓程式碼下來編譯&lt;br&gt;
如果是靜態頁面，就只有抓下來 (畢竟我們的 Build setting 是空的)&lt;br&gt;
完成會自動給一個自動分配的網址，例如本站就是 &lt;a class=&#34;link&#34; href=&#34;https://blog-public-3io.pages.dev&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;blog-public-3io.pages.dev&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;需要自訂網址可以到專案的 Custom domains 設定，免費版有使用上限 &lt;a class=&#34;link&#34; href=&#34;#%e5%85%8d%e8%b2%bb%e7%89%88%e4%bd%bf%e7%94%a8%e9%99%90%e5%88%b6&#34; &gt;免費版限制&lt;/a&gt;&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-domain.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-domain_hu_69774ed5b2b8ffc.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-domain_hu_4a5f730face95697.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare domain&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;到這邊就完成了🎉&lt;/p&gt;
&lt;p&gt;用 Cloudflare 還有個好處，Cloudflare 會自動套 Web Analytics&lt;br&gt;
&lt;img src=&#34;https://zonego.tw/post/cloudflare-page/cfpage-web-analytics.png&#34;
	width=&#34;2876&#34;
	height=&#34;1574&#34;
	srcset=&#34;https://zonego.tw/post/cloudflare-page/cfpage-web-analytics_hu_741bd9c3c8f7722f.png 480w, https://zonego.tw/post/cloudflare-page/cfpage-web-analytics_hu_65dbc686814833d5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Cloudflare web analytics&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;免費版使用限制&#34;&gt;&lt;a href=&#34;#%e5%85%8d%e8%b2%bb%e7%89%88%e4%bd%bf%e7%94%a8%e9%99%90%e5%88%b6&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;免費版使用限制
&lt;/h2&gt;&lt;p&gt;根據&lt;a class=&#34;link&#34; href=&#34;https://developers.cloudflare.com/pages/platform/limits&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;官方文件&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;每個帳號可以件幾個網站專案、預覽板本好像沒限制&lt;/p&gt;
&lt;h3 id=&#34;建置&#34;&gt;&lt;a href=&#34;#%e5%bb%ba%e7%bd%ae&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;建置
&lt;/h3&gt;&lt;p&gt;免費版能從 GitHub 抓程式碼重新建置每個月500次，建置時間不得過20分鐘&lt;br&gt;
推送程式碼到 GitHub 也會觸發重新建置&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;所以我習慣在本機把 hexo 建制好，再推送到 GitHub，省編譯時間&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;domains&#34;&gt;&lt;a href=&#34;#domains&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;Domains
&lt;/h3&gt;&lt;p&gt;最多 10 個自訂 domain&lt;/p&gt;
&lt;h3 id=&#34;檔案&#34;&gt;&lt;a href=&#34;#%e6%aa%94%e6%a1%88&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;檔案
&lt;/h3&gt;&lt;p&gt;單一個網站專案，最多到 2 萬個檔案&lt;br&gt;
單一檔案、素材最大 25MB&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;有放圖片要注意下容量&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;headers&#34;&gt;&lt;a href=&#34;#headers&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;Headers
&lt;/h3&gt;&lt;p&gt;最多 100 header 規則&lt;/p&gt;
&lt;h3 id=&#34;重導向規則&#34;&gt;&lt;a href=&#34;#%e9%87%8d%e5%b0%8e%e5%90%91%e8%a6%8f%e5%89%87&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;重導向規則
&lt;/h3&gt;&lt;p&gt;最多 100 個&lt;/p&gt;
</description>
        </item>
        <item>
        <title>drone-git-push 踩雷心得</title>
        <link>https://zonego.tw/post/drone-git-push/</link>
        <pubDate>Thu, 06 Jan 2022 20:15:54 +0800</pubDate>
        
        <guid>https://zonego.tw/post/drone-git-push/</guid>
        <description>&lt;img src="https://zonego.tw/post/drone-git-push/DroneCI.jpg" alt="Featured image of post drone-git-push 踩雷心得" /&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.drone.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Drone CI&lt;/a&gt; 是一個可以自行架設的 CI (Continuous Integration) 軟體&lt;/p&gt;
&lt;p&gt;使用 CI 的用意就是為了，能在寫完程式時，自動測試、編譯與發佈程式。&lt;/p&gt;
&lt;p&gt;關於怎麼架設改天再寫一篇教學。 &lt;del&gt;Google一下應該就很多教學了&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&#34;drone-git-push&#34;&gt;&lt;a href=&#34;#drone-git-push&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;drone-git-push
&lt;/h2&gt;&lt;p&gt;回來本篇主題&lt;/p&gt;
&lt;p&gt;這次我的需求是在 Drone 的流程內，測試或編譯完程式後以 git 推送到不同的儲藏庫&lt;br&gt;
其實就是要產生網站檔案後，推送到 GitHub 方便用 GitHub Page 或是 Cloudflare Page&lt;/p&gt;
&lt;p&gt;在 Drone CI 中可以用 &lt;a class=&#34;link&#34; href=&#34;http://plugins.drone.io/appleboy/drone-git-push/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;drone-git-push&lt;/a&gt; 做到&lt;/p&gt;
&lt;p&gt;這次遇到的問題有2個 &lt;del&gt;害我為了找問題多花很多時間&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&#34;儲存庫辨識失敗&#34;&gt;&lt;a href=&#34;#%e5%84%b2%e5%ad%98%e5%ba%ab%e8%be%a8%e8%ad%98%e5%a4%b1%e6%95%97&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;儲存庫辨識失敗
&lt;/h2&gt;&lt;p&gt;錯誤訊息:&lt;/p&gt;

&lt;div class=&#34;terminal&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;

    
    &lt;div class=&#34;terminal-title&#34;&gt;terminal&lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&#34;terminal-block&#34;&gt;
    &lt;p&gt;parse &amp;quot;git@github.com:user/repo.git&amp;quot;: first path segment in URL cannot contain colon&amp;quot;&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;照原本文件寫的 &lt;code&gt;.drone.yml&lt;/code&gt; 大概是長這樣&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yaml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yaml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deploy git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;branch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;git@github.com:user/repo.git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;force&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;commit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;參考&lt;a class=&#34;link&#34; href=&#34;https://github.com/appleboy/drone-git-push/issues/40&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GitHub討論區&lt;/a&gt;的解決方法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用緊急修補的 image&lt;/li&gt;
&lt;li&gt;remote 改用字串&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yaml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yaml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deploy git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push:0.2.0-linux-amd64&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;branch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;git@github.com:user/repo.git&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;force&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;commit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h2 id=&#34;ssh-key-讀取失敗&#34;&gt;&lt;a href=&#34;#ssh-key-%e8%ae%80%e5%8f%96%e5%a4%b1%e6%95%97&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;SSH Key 讀取失敗
&lt;/h2&gt;&lt;p&gt;由於資安的關係， SSH KEY 不可以跟著程式碼推送到儲存庫，更不可能放明碼在設定檔中&lt;/p&gt;
&lt;p&gt;在 Drone CI 要改用 secret 的功能&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.drone.yml&lt;/code&gt; 大概長這樣&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yaml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yaml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deploy git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;appleboy/drone-git-push:0.2.0-linux-amd64&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;branch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ssh_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from_secret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;githubkey&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;另外在 Drone CI 的 WebUI 上添加 Secret&lt;/p&gt;
&lt;p&gt;將 private key 的內文貼進去&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonego.tw/post/drone-git-push/DroneCI-secret.png&#34;
	width=&#34;1733&#34;
	height=&#34;682&#34;
	srcset=&#34;https://zonego.tw/post/drone-git-push/DroneCI-secret_hu_4f2816f1a6291bd2.png 480w, https://zonego.tw/post/drone-git-push/DroneCI-secret_hu_1783338f4ff44d1a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;secret&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;254&#34;
		data-flex-basis=&#34;609px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;然後就碰到問題了&lt;/p&gt;
&lt;p&gt;錯誤訊息:&lt;/p&gt;

&lt;div class=&#34;terminal&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;

    
    &lt;div class=&#34;terminal-title&#34;&gt;terminal&lt;/div&gt;
    
  &lt;/div&gt;
  &lt;div class=&#34;terminal-block&#34;&gt;
    &lt;p&gt;Load key &amp;ldquo;/root/.ssh/id_rsa&amp;rdquo;: invalid format&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;參考&lt;a class=&#34;link&#34; href=&#34;https://github.com/appleboy/drone-git-push/issues/37&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GitHub討論區&lt;/a&gt;的解決方法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;產生的 SSH key 需要改用 PEM&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;terminal&#34; role=&#34;figure&#34; aria-label=&#34;terminal code snippet&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class=&#34;terminal-title&#34;&gt;
     &gt;_ terminal
    &lt;/div&gt;
    
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh-keygen -t rsa -b 4096 -C &amp;#34;your_email@example.com&amp;#34; -m PEM&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;p&gt;換完 KEY 甚麼問題都沒了🎉&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Gitea - 自己的 Git 自己架</title>
        <link>https://zonego.tw/post/gitea/</link>
        <pubDate>Thu, 25 Nov 2021 19:22:30 +0800</pubDate>
        
        <guid>https://zonego.tw/post/gitea/</guid>
        <description>&lt;img src="https://zonego.tw/post/gitea/Gitea.jpg" alt="Featured image of post Gitea - 自己的 Git 自己架" /&gt;&lt;p&gt;作為寫過程式的人，Git是必備工具 &lt;del&gt;除非只是寫好玩的&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;常見的線上Git儲藏庫就是 &lt;a class=&#34;link&#34; href=&#34;https://github.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GitHub&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://about.gitlab.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Gitlab&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://bitbucket.org/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Bitbucket&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;如果對於這些公開平台不放心，或是程式碼不想外流，那就自己架私服吧!&lt;/p&gt;
&lt;p&gt;常見的有 &lt;a class=&#34;link&#34; href=&#34;https://gitea.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Gitea&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;https://gogs.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;gogs&lt;/a&gt;或是&lt;a class=&#34;link&#34; href=&#34;https://about.gitlab.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Gitlab&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gitlab裡面包含 CI/CD 工具等功能，十分肥大&lt;/p&gt;
&lt;p&gt;想要一個安裝簡單、有完整git功能又有中文介面，那就選 Gitea 吧！&lt;/p&gt;
&lt;h2 id=&#34;安裝&#34;&gt;&lt;a href=&#34;#%e5%ae%89%e8%a3%9d&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;安裝
&lt;/h2&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://docs.gitea.io/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;說明文件&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gitea 提供很多安裝方式，我這邊選則用 docker &lt;del&gt;手邊有現成的docker伺服器，不用白不用&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://docs.gitea.io/zh-tw/install-with-docker-rootless/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;docker-compose 安裝說明&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;選擇版本&#34;&gt;&lt;a href=&#34;#%e9%81%b8%e6%93%87%e7%89%88%e6%9c%ac&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;選擇版本
&lt;/h3&gt;&lt;p&gt;Gitea 的官方映像可以在 &lt;a class=&#34;link&#34; href=&#34;https://hub.docker.com/r/gitea/gitea/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Docker Hub&lt;/a&gt; 找到&lt;/p&gt;
&lt;p&gt;版本 tag 與 Gitea 的 &lt;a class=&#34;link&#34; href=&#34;https://github.com/go-gitea/gitea&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Github&lt;/a&gt; 上發布的版本號一樣&lt;/p&gt;
&lt;p&gt;&lt;code&gt;latest&lt;/code&gt; 則是最新的穩定版&lt;/p&gt;
&lt;h3 id=&#34;選擇資料庫&#34;&gt;&lt;a href=&#34;#%e9%81%b8%e6%93%87%e8%b3%87%e6%96%99%e5%ba%ab&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;選擇資料庫
&lt;/h3&gt;&lt;p&gt;Gitea 支援多種資料庫，例如 &lt;code&gt;mysql&lt;/code&gt; &lt;code&gt;mariadb&lt;/code&gt; &lt;code&gt;PostgreSQL&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;安裝過程&#34;&gt;&lt;a href=&#34;#%e5%ae%89%e8%a3%9d%e9%81%8e%e7%a8%8b&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;安裝過程
&lt;/h2&gt;&lt;p&gt;使用 docker-compose 安裝&lt;/p&gt;
&lt;p&gt;我這邊選用 mysql 資料庫&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yaml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yaml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 docker-compose.yml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;docker-compose.yml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gitea/gitea:1.15.6-rootless&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;environment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;GITEA__database__DB_TYPE=mysql&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;GITEA__database__HOST=db:3306&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;GITEA__database__NAME=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;GITEA__database__USER=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;GITEA__database__PASSWD=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;./data:/var/lib/gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;./config:/etc/gitea  &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;/etc/timezone:/etc/timezone:ro&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;/etc/localtime:/etc/localtime:ro&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;10080:3000&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;10022:22&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;depends_on&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mysql:8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;restart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;environment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;MYSQL_ROOT_PASSWORD=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;MYSQL_USER=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;MYSQL_PASSWORD=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;MYSQL_DATABASE=gitea&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;./mysql:/var/lib/mysql&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;執行&lt;/p&gt;
&lt;div class=&#34;terminal&#34; role=&#34;figure&#34; aria-label=&#34;terminal code snippet&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class=&#34;terminal-title&#34;&gt;
     &gt;_ terminal
    &lt;/div&gt;
    
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker-compose up&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;p&gt;完成後可以用 &lt;a class=&#34;link&#34; href=&#34;http://hostname:10080&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://hostname:10080&lt;/a&gt; 連到你剛剛架的 gitea&lt;/p&gt;
&lt;p&gt;SSH 要使用 10022 例如&lt;/p&gt;
&lt;div class=&#34;terminal&#34; role=&#34;figure&#34; aria-label=&#34;terminal code snippet&#34;&gt;
  &lt;div class=&#34;terminal-header&#34;&gt;
    &lt;div class=&#34;terminal-btn&#34;&gt;
      &lt;div class=&#34;btn-mac mac-close&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-mini&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;btn-mac mac-full&#34;&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class=&#34;terminal-title&#34;&gt;
     &gt;_ terminal
    &lt;/div&gt;
    
  &lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone ssh://git@hostname:10022/username/repo.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;&lt;p&gt;如果想用預設 Port&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;yaml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; yaml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;#將這段&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;10080:3000&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;10022:22&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#換成這段&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;80:3000&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;22:22&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;到這邊自己用應該夠了，後續如果要在外網使用，建議還是設定網段 + SSl憑證 (弄成https) 會比較安全&lt;/p&gt;
&lt;h2 id=&#34;設定-revers-proxy&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a-revers-proxy&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定 revers proxy
&lt;/h2&gt;&lt;p&gt;我自己是使用 traefik 做 revers proxy&lt;br&gt;
由於之前是用 haproxy ，改用 traefik 之後還是習慣用檔案手動設定&lt;br&gt;
後面的範例會以設定檔的方式為主，也可以參考官方文件改成 docker labels&lt;/p&gt;
&lt;h3 id=&#34;https&#34;&gt;&lt;a href=&#34;#https&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;https
&lt;/h3&gt;&lt;p&gt;我的 traefik 有設定監看資料夾的動態設定檔，service 跟 router 分別在不同檔案&lt;br&gt;
如果沒有用動態設定檔的話，設定應該都在 traefik.toml 只不過改完後要重開&lt;/p&gt;
&lt;h4 id=&#34;啟用動態設定檔&#34;&gt;&lt;a href=&#34;#%e5%95%9f%e7%94%a8%e5%8b%95%e6%85%8b%e8%a8%ad%e5%ae%9a%e6%aa%94&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;啟用動態設定檔
&lt;/h4&gt;&lt;p&gt;directory 可以自行更換&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;toml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; toml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 traefik.toml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;traefik.toml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;providers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;providers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;directory&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/traefik/dynamic_configs&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;watch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h4 id=&#34;設定-lets-encrypt-自動申請憑證&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a-lets-encrypt-%e8%87%aa%e5%8b%95%e7%94%b3%e8%ab%8b%e6%86%91%e8%ad%89&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定 let&amp;rsquo;s encrypt 自動申請憑證
&lt;/h4&gt;&lt;p&gt;驗證方式有幾種可以選，一般常用的是 http Challenge&lt;/p&gt;
&lt;p&gt;我的網站有套用 cloudflare 保護，DNS 代理就轉過去 cloudflare 了&lt;br&gt;
外加 cloudflare 有支援 dns Challenge，乾脆就用這種 DNS 驗證比較省事&lt;br&gt;
如果你的網域租賃商有提供 dns Challenge，也可以用這種方式驗證比較簡單&lt;br&gt;
只要設定一次，可以套用多個網域&lt;/p&gt;
&lt;p&gt;resolvers 可以改成你的網域租賃商，我這邊寫的是 cloudflare 的 DNS&lt;br&gt;
如果要套用 cloudflare 的防護，這邊不用改&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;toml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; toml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 traefik.toml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;traefik.toml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;certificatesResolvers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cloudflare-resolver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;acme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;email&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;youremail@gmail.com&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;storage&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/etc/traefik/acme.json&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;certificatesResolvers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cloudflare-resolver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;acme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dnsChallenge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;provider&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cloudflare&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;delayBeforeCheck&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;resolvers&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1.1.1.1:53&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0.0.1:53&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h4 id=&#34;設定-entry-point&#34;&gt;&lt;a href=&#34;#%e8%a8%ad%e5%ae%9a-entry-point&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;設定 entry point
&lt;/h4&gt;&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;toml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; toml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 traefik.toml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;traefik.toml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ssh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;:22&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;web&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;:80&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;websecure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;:443&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;websecure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;certResolver&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cloudflare-resolver&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;h4 id=&#34;添加後端跟路由&#34;&gt;&lt;a href=&#34;#%e6%b7%bb%e5%8a%a0%e5%be%8c%e7%ab%af%e8%b7%9f%e8%b7%af%e7%94%b1&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;添加後端跟路由
&lt;/h4&gt;&lt;p&gt;添加 http service&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;toml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; toml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 /etc/traefik/dynamic_configs/service.toml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;/etc/traefik/dynamic_configs/service.toml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gitea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;loadBalancer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c&#34;&gt;# healthCheck 是讓 traefik 檢查 gitea 伺服器是否還活著，不要可以去掉&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gitea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;loadBalancer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;healthCheck&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;scheme&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;interval&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10s&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;timeout&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;3s&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;services&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gitea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;loadBalancer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://gitea-ip:3000&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;再來是添加 router&lt;/p&gt;
&lt;figure class=&#34;code-block&#34; role=&#34;figure&#34; aria-label=&#34;toml code snippet&#34;&gt;

  &lt;div class=&#34;code-header&#34;&gt;
    &lt;span class=&#34;code-type&#34;&gt;&amp;lt;/&amp;gt; toml&lt;/span&gt;
    &lt;span  class=&#34;code-title&#34;&gt;📄 /etc/traefik/dynamic_configs/routre.toml&lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34; title=&#34;/etc/traefik/dynamic_configs/routre.toml&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;routers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;routers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;git&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;entryPoints&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;websecure&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;rule&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host(`git.your.domain`)&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;gitea&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;routers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;git&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;certResolver&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cloudflare-resolver&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/figure&gt;&lt;p&gt;這樣就完成了&lt;/p&gt;
&lt;h3 id=&#34;ssh&#34;&gt;&lt;a href=&#34;#ssh&#34; class=&#34;header-anchor&#34;&gt;&lt;/a&gt;ssh
&lt;/h3&gt;&lt;p&gt;git 使用 key 做身分認證時必須要走 ssh 的協定，如果要使用就必須做好轉發&lt;/p&gt;
&lt;p&gt;在 revers proxy 設定連接 就直接轉到 gitea 伺服器&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
